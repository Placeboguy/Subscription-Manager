# System Architecture & Data Flow

## ğŸ—ï¸ Complete System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     USER'S BROWSER                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚           REACT FRONTEND (Vite)                           â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  AuthPage.jsx (Login/Signup)                        â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - User Registration                                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - User Login                                        â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - GradientBlinds Background                         â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - Error Handling & Validation                       â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  Dashboard, AllSubscriptions, Settings Pages        â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - Display User Data                                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - CRUD Operations                                  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - Charts & Statistics                              â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  SubscriptionContext (State Management)             â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - Subscriptions State                              â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - Stats State                                      â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  - Loading & Error States                           â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  src/services/api.js (HTTP Layer)                         â”‚  â”‚
â”‚  â”‚  - authAPI.register()                                     â”‚  â”‚
â”‚  â”‚  - authAPI.login()                                        â”‚  â”‚
â”‚  â”‚  - subscriptionAPI.getAll()                              â”‚  â”‚
â”‚  â”‚  - subscriptionAPI.add()                                 â”‚  â”‚
â”‚  â”‚  - subscriptionAPI.update()                              â”‚  â”‚
â”‚  â”‚  - subscriptionAPI.delete()                              â”‚  â”‚
â”‚  â”‚  - localStorage management (tokens)                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“ HTTP/REST
          Authorization: Bearer <JWT_TOKEN>
          Content-Type: application/json
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SERVER (Node.js/Express)                     â”‚
â”‚                 http://localhost:5000                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  server.js (Express App)                                 â”‚  â”‚
â”‚  â”‚  - CORS middleware (enables cross-origin requests)       â”‚  â”‚
â”‚  â”‚  - JSON parser middleware                                â”‚  â”‚
â”‚  â”‚  - Route handlers                                        â”‚  â”‚
â”‚  â”‚  - Error handler                                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  routes/auth.js                                          â”‚  â”‚
â”‚  â”‚  - POST /api/auth/register â†’ authController.register()   â”‚  â”‚
â”‚  â”‚  - POST /api/auth/login â†’ authController.login()         â”‚  â”‚
â”‚  â”‚  - GET /api/auth/me â†’ authController.getMe()             â”‚  â”‚
â”‚  â”‚    (with protect middleware)                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  routes/subscriptions.js                                 â”‚  â”‚
â”‚  â”‚  - GET /api/subscriptions â†’ getSubscriptions()           â”‚  â”‚
â”‚  â”‚  - POST /api/subscriptions â†’ addSubscription()           â”‚  â”‚
â”‚  â”‚  - GET /api/subscriptions/stats/overview â†’ getStats()    â”‚  â”‚
â”‚  â”‚  - GET /api/subscriptions/:id â†’ getSubscription()        â”‚  â”‚
â”‚  â”‚  - PUT /api/subscriptions/:id â†’ updateSubscription()     â”‚  â”‚
â”‚  â”‚  - DELETE /api/subscriptions/:id â†’ deleteSubscription()  â”‚  â”‚
â”‚  â”‚  (all with protect middleware)                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  middleware/auth.js                                      â”‚  â”‚
â”‚  â”‚  - protect middleware                                    â”‚  â”‚
â”‚  â”‚    â€¢ Extracts JWT from Authorization header              â”‚  â”‚
â”‚  â”‚    â€¢ Verifies token signature                            â”‚  â”‚
â”‚  â”‚    â€¢ Attaches decoded user ID to req.user                â”‚  â”‚
â”‚  â”‚    â€¢ Returns 401 if invalid/missing token                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  controllers/authController.js                           â”‚  â”‚
â”‚  â”‚  - register()                                            â”‚  â”‚
â”‚  â”‚    â€¢ Validate input (name, email, password)              â”‚  â”‚
â”‚  â”‚    â€¢ Check if email exists                               â”‚  â”‚
â”‚  â”‚    â€¢ Hash password with bcryptjs                         â”‚  â”‚
â”‚  â”‚    â€¢ Save user to DB                                     â”‚  â”‚
â”‚  â”‚    â€¢ Generate JWT token                                  â”‚  â”‚
â”‚  â”‚    â€¢ Return token + user info                            â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  - login()                                               â”‚  â”‚
â”‚  â”‚    â€¢ Validate input (email, password)                    â”‚  â”‚
â”‚  â”‚    â€¢ Find user by email                                  â”‚  â”‚
â”‚  â”‚    â€¢ Compare password with hash                          â”‚  â”‚
â”‚  â”‚    â€¢ Generate JWT token                                  â”‚  â”‚
â”‚  â”‚    â€¢ Return token + user info                            â”‚  â”‚
â”‚  â”‚                                                           â”‚  â”‚
â”‚  â”‚  - getMe()                                               â”‚  â”‚
â”‚  â”‚    â€¢ Get current user from req.user.id                   â”‚  â”‚
â”‚  â”‚    â€¢ Return user data (protected)                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  controllers/subscriptionController.js                   â”‚  â”‚
â”‚  â”‚  - getSubscriptions()                                    â”‚  â”‚
â”‚  â”‚    â€¢ Query: {userId: req.user.id}                        â”‚  â”‚
â”‚  â”‚  - addSubscription()                                     â”‚  â”‚
â”‚  â”‚    â€¢ Create with userId: req.user.id                     â”‚  â”‚
â”‚  â”‚    â€¢ Auto-calc nextBillingDate                           â”‚  â”‚
â”‚  â”‚  - getStats()                                            â”‚  â”‚
â”‚  â”‚    â€¢ Filter by userId & status='active'                  â”‚  â”‚
â”‚  â”‚    â€¢ Calculate monthly/yearly totals                     â”‚  â”‚
â”‚  â”‚  - updateSubscription()                                  â”‚  â”‚
â”‚  â”‚    â€¢ Check user owns subscription                        â”‚  â”‚
â”‚  â”‚    â€¢ Update fields                                       â”‚  â”‚
â”‚  â”‚  - deleteSubscription()                                  â”‚  â”‚
â”‚  â”‚    â€¢ Check user owns subscription                        â”‚  â”‚
â”‚  â”‚    â€¢ Delete from database                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  config/db.js                                            â”‚  â”‚
â”‚  â”‚  - connectDB()                                           â”‚  â”‚
â”‚  â”‚    â€¢ Connects to MongoDB                                 â”‚  â”‚
â”‚  â”‚    â€¢ Uses MONGODB_URI from .env                          â”‚  â”‚
â”‚  â”‚    â€¢ Logs connection status                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“ Mongoose Queries
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     MONGODB DATABASE                            â”‚
â”‚                   (localhost:27017)                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  database: subscription-manager                          â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  collections/users (User Model)                    â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  {                                                 â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    _id: ObjectId,                                  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    name: String,                                   â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    email: String (unique),                         â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    password: String (hashed),                      â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    createdAt: Date,                                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    updatedAt: Date                                 â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  }                                                 â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  collections/subscriptions (Subscription Model)    â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  {                                                 â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    _id: ObjectId,                                  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    userId: ObjectId (ref User),                    â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    name: String,                                   â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    category: String,                               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    price: Number,                                  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    frequency: String (monthly|yearly),             â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    status: String (active|paused|cancelled),       â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    startDate: Date,                                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    nextBillingDate: Date,                          â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    description: String,                            â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    createdAt: Date,                                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    updatedAt: Date                                 â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  }                                                 â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Authentication Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User Opens    â”‚
â”‚   Application   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Check localStorage for token       â”‚
â”‚  & userInfo                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                       â”‚
    â–¼ (Token exists)        â–¼ (No token)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Go to        â”‚      â”‚ Show AuthPage    â”‚
â”‚ Dashboard    â”‚      â”‚ (Login/Signup)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚                        â”‚
                   â–¼ (Sign Up)              â–¼ (Login)
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Register Route â”‚      â”‚ Login Route   â”‚
            â”‚ POST /register â”‚      â”‚ POST /login   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚                      â”‚
                     â–¼                      â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ Create user        â”‚  â”‚ Find user        â”‚
            â”‚ Hash password      â”‚  â”‚ Check password   â”‚
            â”‚ Save to MongoDB    â”‚  â”‚ match            â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚                     â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Generate JWT Token     â”‚
                    â”‚ Return token + user    â”‚
                    â”‚ Save to localStorage   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Go to Dashboard        â”‚
                    â”‚ Token now in every     â”‚
                    â”‚ API request header     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” API Request with JWT Authentication

```
FRONTEND REQUEST:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GET /api/subscriptions                 â”‚
â”‚ Headers: {                             â”‚
â”‚   "Authorization": "Bearer eyJhbGci..." â”‚
â”‚   "Content-Type": "application/json"   â”‚
â”‚ }                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backend receives request               â”‚
â”‚ routes/subscriptions.js calls protect  â”‚
â”‚ middleware                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ middleware/auth.js (protect)           â”‚
â”‚ 1. Extract token from header           â”‚
â”‚ 2. Verify token signature with secret  â”‚
â”‚ 3. Decode token â†’ get user ID          â”‚
â”‚ 4. Attach to req.user.id               â”‚
â”‚ 5. Call next() to proceed              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Controller function receives request   â”‚
â”‚ Has access to: req.user.id             â”‚
â”‚ Queries: {userId: req.user.id}         â”‚
â”‚ Returns only user's subscriptions      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BACKEND RESPONSE:                      â”‚
â”‚ {                                      â”‚
â”‚   "success": true,                     â”‚
â”‚   "count": 5,                          â”‚
â”‚   "data": [                            â”‚
â”‚     {...subscription objects...}       â”‚
â”‚   ]                                    â”‚
â”‚ }                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
FRONTEND receives & displays data
```

---

## ğŸ’¾ Data Isolation Architecture

```
Database View:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MongoDB: subscription-manager        â”‚
â”‚                                      â”‚
â”‚ Users Collection:                    â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ User 1: john@example.com       â”‚  â”‚
â”‚ â”‚ User 2: alice@example.com      â”‚  â”‚
â”‚ â”‚ User 3: bob@example.com        â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚ Subscriptions Collection:            â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ Subscription {                 â”‚  â”‚
â”‚ â”‚   userId: User1._id,           â”‚  â”‚
â”‚ â”‚   name: "Netflix"              â”‚  â”‚
â”‚ â”‚ }                              â”‚  â”‚
â”‚ â”‚ Subscription {                 â”‚  â”‚
â”‚ â”‚   userId: User1._id,           â”‚  â”‚
â”‚ â”‚   name: "Spotify"              â”‚  â”‚
â”‚ â”‚ }                              â”‚  â”‚
â”‚ â”‚ Subscription {                 â”‚  â”‚
â”‚ â”‚   userId: User2._id,           â”‚  â”‚
â”‚ â”‚   name: "Netflix"              â”‚  â”‚
â”‚ â”‚ }                              â”‚  â”‚
â”‚ â”‚ (User 3 has no subscriptions)  â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

When User1 logs in and requests subscriptions:
â†’ Backend executes: db.subscriptions.find({userId: User1._id})
â†’ Returns ONLY User1's Netflix & Spotify subscriptions
â†’ User2's Netflix subscription is NOT returned
â†’ Complete data isolation!
```

---

## ğŸ›¡ï¸ Security Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 1: Input Validation               â”‚
â”‚ - Email format check                    â”‚
â”‚ - Password length check                 â”‚
â”‚ - Required fields validation            â”‚
â”‚ - Data type checking                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 2: Database Constraints           â”‚
â”‚ - Unique email constraint               â”‚
â”‚ - Required field enforcement            â”‚
â”‚ - Min/max value checks                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 3: Password Encryption            â”‚
â”‚ - bcryptjs hashing (10 salt rounds)     â”‚
â”‚ - Password never stored in plaintext    â”‚
â”‚ - Comparison via bcryptjs.compare()     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 4: JWT Authentication             â”‚
â”‚ - Generate token with user ID           â”‚
â”‚ - 30-day expiration                     â”‚
â”‚ - Signed with secret key                â”‚
â”‚ - Verified on protected routes          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 5: Authorization                  â”‚
â”‚ - Check user owns resource              â”‚
â”‚ - userId match before update/delete     â”‚
â”‚ - User-specific data queries            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Example User Journey

**Time: 2025-02-15 10:00 AM**

```
1. User visits http://localhost:5173
   â””â”€ App checks localStorage
   â””â”€ No token found
   â””â”€ Shows AuthPage

2. User clicks "Need an account? Sign Up"
   â””â”€ Form appears with Name, Email, Password fields

3. User enters:
   - Name: "Alice"
   - Email: "alice@example.com"
   - Password: "SecurePass123"
   â””â”€ Clicks "Sign Up"

4. Frontend sends request:
   POST /api/auth/register
   Body: {name: "Alice", email: "alice@example.com", password: "SecurePass123"}

5. Backend receives request:
   - Validates: name, email format, password length
   - Checks: email not in database
   - Hashes password: "SecurePass123" â†’ "$2a$10$..." (bcryptjs)
   - Creates User document in MongoDB
   - Generates JWT: "eyJhbGci..." (valid for 30 days)
   - Returns: {token: "eyJhbGci...", user: {id: "...", name: "Alice", email: "alice@example.com"}}

6. Frontend receives response:
   - Saves token to localStorage
   - Saves user info to localStorage
   - Sets isLoggedIn = true
   - Shows Dashboard

7. User sees Dashboard:
   - Stats: 0 active subscriptions, $0 monthly cost
   - Sidebar with Dashboard, All Subscriptions, Settings
   - "Add Subscription" button

8. User clicks "Add Subscription":
   - Form popup appears
   - Enters: Name: "Netflix", Price: 15.99, Frequency: "monthly"
   - Clicks "Add"

9. Frontend sends request:
   POST /api/subscriptions
   Headers: {Authorization: "Bearer eyJhbGci..."}
   Body: {name: "Netflix", price: 15.99, frequency: "monthly"}

10. Backend:
    - Middleware verifies JWT token
    - Extracts userId from token
    - Creates Subscription with userId
    - Auto-calculates nextBillingDate: 2025-03-15
    - Saves to MongoDB
    - Returns created subscription

11. Frontend:
    - Updates SubscriptionContext
    - Dashboard refreshes:
      - Stats now show: 1 active, $15.99 monthly, $191.88 yearly
    - Subscription appears in list

12. User clicks Logout
    - Frontend clears localStorage (token + user info)
    - Shows AuthPage again
    - Next login will generate new token

13. User logs back in with email & password
    - Backend finds user by email
    - Compares password with stored hash
    - Generates new JWT token
    - Returns user's existing subscriptions
    - Dashboard shows Netflix subscription (data persisted!)
```

---

## ğŸ¯ Key Takeaways

1. **Frontend â†’ Backend Communication**: All via HTTP/REST API
2. **Authentication**: JWT tokens stored in localStorage
3. **Authorization**: Middleware checks JWT on protected routes
4. **Data Isolation**: Each user only sees their own data (userId filtering)
5. **Security**: Passwords hashed, tokens signed, input validated
6. **Persistence**: MongoDB stores all data
7. **User Experience**: Seamless login/signup with persistent sessions

---

This architecture ensures:
- âœ… Users can't access other users' data
- âœ… Passwords are secure and encrypted
- âœ… Sessions persist across page refreshes
- âœ… All requests are authenticated
- âœ… Data is safely stored in database
